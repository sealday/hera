import React, { useEffect } from 'react'

import moment from 'moment'
import { Button, Card, Tag, Descriptions } from 'antd'
import { connect, useDispatch, useSelector } from 'react-redux'
import { CONTRACT_DETAILS, queryContractDetails } from '../../../actions'
import { percentFormat, rentExcelExport } from '../../../utils'
import RentCalcTable from '../RentCalcTable'
import { useParams } from 'utils/hooks'
import { ModalPrintPreviewButton, PageHeader } from '../../../components'
import _ from 'lodash'
import heraApi from 'api'

const ProjectLabel = connect(state => ({
  projects: state.system.projects,
}))(({ projects, projectId }) => {
  if (projects && projects.get(projectId)) {
    return <>{projects.get(projectId).completeName}</>
  }
  return <>projectId</>
})

const ContractDetailsCalc = () => {
  const dispatch = useDispatch()
  let contract = useSelector(state => state.results.get(CONTRACT_DETAILS, {}))
  const projects = useSelector(state => state.system.projects)
  const projectName = projects
    ? _.get(projects.get(contract.project), 'completeName', '')
    : ''
  const { id, calcId } = useParams()
  const [restartCal, restartResult] = heraApi.useRestartCalcContractMutation()
  useEffect(() => {
    dispatch(queryContractDetails(id))
  }, [id])

  useEffect(() => {
    if (restartResult.isSuccess) {
      dispatch(queryContractDetails(id))
    }
  }, [restartResult.isSuccess])

  let currentCalc = null
  contract = {
    tags: [],
    _id: '617f9ddd13e68937aca8cad5',
    name: '上海丰耀建设工程有限公司【丁茂恒】',
    code: '5121',
    project: '617f9d0613e68937aca8cad2',
    address: '松江方塔北路571号10号场',
    date: '2021-10-01T07:57:08.180Z',
    status: '进行',
    meta: [],
    items: [
      {
        category: '租金',
        plan: '638eefc68a226740575b826f',
        weight: '63bcf1174e2d809c8729e053',
        start: '2021-12-31T16:00:00.000Z',
        end: '2022-12-30T16:00:00.000Z',
        _id: '63bf93634e2d809c872e3735',
      },
      {
        category: '租金',
        plan: '5ed9fc6382774632b905a4b2',
        weight: '60d95d0513e68937aca86909',
        start: '2020-12-31T16:00:00.000Z',
        end: '2021-12-30T16:00:00.000Z',
        _id: '63c0c64c4e2d809c872faa10',
      },
      {
        category: '租金',
        plan: '63d9c2374e2d809c873513ed',
        weight: '63bcf1174e2d809c8729e053',
        start: '2022-12-31T16:00:00.000Z',
        end: '2023-12-30T16:00:00.000Z',
        _id: '63e5e32b4e2d809c87455b0c',
      },
    ],
    calcs: [
      {
        name: '10月结算表',
        start: '2021-09-30T16:00:00.000Z',
        end: '2021-10-30T16:00:00.000Z',
        status: 'latest',
        history: [],
        list: [
          {
            _id: {
              year: 2021,
              month: 10,
              day: 30,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2021-10-30T13:04:49.583Z',
            number: 2102,
            name: 'Φ48盘扣立杆',
            count: -8774.5,
            days: 2,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -114.0685,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2021,
              month: 10,
              day: 30,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2021-10-30T13:04:49.583Z',
            number: 3004,
            name: '盘扣立杆架',
            count: -10,
            days: 2,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
        ],
        group: { price: -114.0685 },
        nameGroup: [
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -10,
            unit: '个',
          },
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: -8774.5,
            unit: '千克',
          },
        ],
        freightGroup: [{ _id: null, freight: 0 }],
        debug: [],
        _id: '617f9e4d13e68937aca8cad9',
      },
      {
        _id: '617f9ee313e68937aca8cb00',
        name: '11 月结算表',
        start: '2021-10-31T16:00:00.000Z',
        end: '2021-11-29T16:00:00.000Z',
        history: [
          {
            _id: '盘扣立杆架',
            name: '盘扣立杆架',
            count: -10,
            days: 30,
            price: 0,
            unit: '个',
            unitPrice: 0,
          },
          {
            _id: 'Φ48盘扣立杆',
            name: 'Φ48盘扣立杆',
            count: -8774.5,
            days: 30,
            price: -1658.3805,
            unit: '千克',
            unitPrice: 0.0063,
          },
        ],
        list: [
          {
            _id: { year: 2021, month: 11, day: 1, name: '钢管', inOut: '出库' },
            outDate: '2021-11-01T08:20:25.522Z',
            number: 8,
            name: '钢管',
            count: 1322.5,
            days: 30,
            inOut: '出库',
            unitPrice: 0.009,
            unitFreight: 0,
            price: 357.07499999999993,
            freight: 0,
            unit: '米',
          },
          {
            _id: { year: 2021, month: 11, day: 1, name: '扣件', inOut: '出库' },
            outDate: '2021-11-01T08:20:25.522Z',
            number: 100,
            name: '扣件',
            count: 810,
            days: 30,
            inOut: '出库',
            unitPrice: 0.005,
            unitFreight: 0,
            price: 121.5,
            freight: 0,
            unit: '只',
          },
        ],
        group: { price: -1179.8055, freight: 0 },
        nameGroup: [
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: -8774.5,
            unit: '千克',
          },
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -10,
            unit: '个',
          },
          { _id: { name: '钢管' }, name: '钢管', count: 1322.5, unit: '米' },
          { _id: { name: '扣件' }, name: '扣件', count: 810, unit: '只' },
        ],
        freightGroup: [{ _id: null, freight: 0 }],
      },
      {
        _id: '61cc0bb413e68937aca922ce',
        name: '12 月结算表',
        start: '2021-11-30T16:00:00.000Z',
        end: '2021-12-30T16:00:00.000Z',
        history: [
          {
            _id: '钢管',
            name: '钢管',
            count: 1322.5,
            days: 31,
            price: 368.97749999999996,
            unit: '米',
            unitPrice: 0.009,
          },
          {
            _id: '扣件',
            name: '扣件',
            count: 810,
            days: 31,
            price: 125.55,
            unit: '只',
            unitPrice: 0.005,
          },
          {
            _id: 'Φ48盘扣立杆',
            name: 'Φ48盘扣立杆',
            count: -8774.5,
            days: 31,
            price: -1713.65985,
            unit: '千克',
            unitPrice: 0.0063,
          },
          {
            _id: '盘扣立杆架',
            name: '盘扣立杆架',
            count: -10,
            days: 31,
            price: 0,
            unit: '个',
            unitPrice: 0,
          },
        ],
        list: [
          {
            _id: {
              year: 2021,
              month: 12,
              day: 15,
              name: '钢管',
              inOut: '出库',
            },
            outDate: '2021-12-15T02:10:31.733Z',
            number: 11,
            name: '钢管',
            count: 900,
            days: 17,
            inOut: '出库',
            unitPrice: 0.009,
            unitFreight: 0,
            price: 137.7,
            freight: 0,
            unit: '米',
          },
          {
            _id: {
              year: 2021,
              month: 12,
              day: 15,
              name: '扣件',
              inOut: '出库',
            },
            outDate: '2021-12-15T02:10:31.733Z',
            number: 102,
            name: '扣件',
            count: 300,
            days: 17,
            inOut: '出库',
            unitPrice: 0.005,
            unitFreight: 0,
            price: 25.5,
            freight: 0,
            unit: '只',
          },
          {
            _id: {
              year: 2021,
              month: 12,
              day: 30,
              name: 'Φ48盘扣立杆',
              inOut: '出库',
            },
            outDate: '2021-12-30T00:50:36.678Z',
            number: 2106,
            name: 'Φ48盘扣立杆',
            count: 6286.0599999999995,
            days: 2,
            inOut: '出库',
            unitPrice: 0.0063,
            unitFreight: 0,
            price: 79.20435599999999,
            freight: 0,
            unit: '千克',
          },
          {
            _id: {
              year: 2021,
              month: 12,
              day: 30,
              name: 'Φ48盘扣横杆',
              inOut: '出库',
            },
            outDate: '2021-12-30T00:50:36.678Z',
            number: 2205,
            name: 'Φ48盘扣横杆',
            count: 95.2,
            days: 2,
            inOut: '出库',
            unitPrice: 0.0063,
            unitFreight: 0,
            price: 1.1995200000000001,
            freight: 0,
            unit: '千克',
          },
          {
            _id: {
              year: 2021,
              month: 12,
              day: 30,
              name: '盘扣立杆架',
              inOut: '出库',
            },
            outDate: '2021-12-30T00:50:36.678Z',
            number: 3004,
            name: '盘扣立杆架',
            count: 4,
            days: 2,
            inOut: '出库',
            unitPrice: 0,
            unitFreight: 0,
            price: 0,
            freight: 0,
            unit: '个',
          },
        ],
        group: { price: -975.5284740000001, freight: 0 },
        nameGroup: [
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -6,
            unit: '个',
          },
          { _id: { name: '扣件' }, name: '扣件', count: 1110, unit: '只' },
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: -2488.4400000000005,
            unit: '千克',
          },
          {
            _id: { name: 'Φ48盘扣横杆' },
            name: 'Φ48盘扣横杆',
            count: 95.2,
            unit: '千克',
          },
          { _id: { name: '钢管' }, name: '钢管', count: 2222.5, unit: '米' },
        ],
        freightGroup: [{ _id: null, freight: 0 }],
      },
      {
        _id: '61d7e86913e68937aca93518',
        name: '2021年结算表',
        start: '2020-12-31T16:00:00.000Z',
        end: '2021-12-30T16:00:00.000Z',
        history: [],
        list: [
          {
            _id: {
              year: 2021,
              month: 10,
              day: 30,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2021-10-30T13:04:49.583Z',
            number: 2102,
            name: 'Φ48盘扣立杆',
            count: -8774.5,
            days: 63,
            inOut: '入库',
            unitPrice: 0.0063,
            unitFreight: 0,
            price: -3482.5990500000003,
            freight: 0,
            unit: '千克',
          },
          {
            _id: {
              year: 2021,
              month: 10,
              day: 30,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2021-10-30T13:04:49.583Z',
            number: 3004,
            name: '盘扣立杆架',
            count: -10,
            days: 63,
            inOut: '入库',
            unitPrice: 0,
            unitFreight: 0,
            price: 0,
            freight: 0,
            unit: '个',
          },
          {
            _id: { year: 2021, month: 11, day: 1, name: '钢管', inOut: '出库' },
            outDate: '2021-11-01T08:20:25.522Z',
            number: 8,
            name: '钢管',
            count: 1322.5,
            days: 61,
            inOut: '出库',
            unitPrice: 0.009,
            unitFreight: 0,
            price: 726.0524999999999,
            freight: 0,
            unit: '米',
          },
          {
            _id: { year: 2021, month: 11, day: 1, name: '扣件', inOut: '出库' },
            outDate: '2021-11-01T08:20:25.522Z',
            number: 100,
            name: '扣件',
            count: 810,
            days: 61,
            inOut: '出库',
            unitPrice: 0.005,
            unitFreight: 0,
            price: 247.04999999999998,
            freight: 0,
            unit: '只',
          },
          {
            _id: {
              year: 2021,
              month: 12,
              day: 15,
              name: '钢管',
              inOut: '出库',
            },
            outDate: '2021-12-15T02:10:31.733Z',
            number: 11,
            name: '钢管',
            count: 900,
            days: 17,
            inOut: '出库',
            unitPrice: 0.009,
            unitFreight: 0,
            price: 137.7,
            freight: 0,
            unit: '米',
          },
          {
            _id: {
              year: 2021,
              month: 12,
              day: 15,
              name: '扣件',
              inOut: '出库',
            },
            outDate: '2021-12-15T02:10:31.733Z',
            number: 102,
            name: '扣件',
            count: 300,
            days: 17,
            inOut: '出库',
            unitPrice: 0.005,
            unitFreight: 0,
            price: 25.5,
            freight: 0,
            unit: '只',
          },
          {
            _id: {
              year: 2021,
              month: 12,
              day: 30,
              name: 'Φ48盘扣立杆',
              inOut: '出库',
            },
            outDate: '2021-12-30T00:50:36.678Z',
            number: 2106,
            name: 'Φ48盘扣立杆',
            count: 6286.0599999999995,
            days: 2,
            inOut: '出库',
            unitPrice: 0.0063,
            unitFreight: 0,
            price: 79.20435599999999,
            freight: 0,
            unit: '千克',
          },
          {
            _id: {
              year: 2021,
              month: 12,
              day: 30,
              name: 'Φ48盘扣横杆',
              inOut: '出库',
            },
            outDate: '2021-12-30T00:50:36.678Z',
            number: 2205,
            name: 'Φ48盘扣横杆',
            count: 95.2,
            days: 2,
            inOut: '出库',
            unitPrice: 0.0063,
            unitFreight: 0,
            price: 1.1995200000000001,
            freight: 0,
            unit: '千克',
          },
          {
            _id: {
              year: 2021,
              month: 12,
              day: 30,
              name: '盘扣立杆架',
              inOut: '出库',
            },
            outDate: '2021-12-30T00:50:36.678Z',
            number: 3004,
            name: '盘扣立杆架',
            count: 4,
            days: 2,
            inOut: '出库',
            unitPrice: 0,
            unitFreight: 0,
            price: 0,
            freight: 0,
            unit: '个',
          },
        ],
        group: { price: -2265.892674, freight: 0 },
        nameGroup: [
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: -2488.4400000000005,
            unit: '千克',
          },
          {
            _id: { name: 'Φ48盘扣横杆' },
            name: 'Φ48盘扣横杆',
            count: 95.2,
            unit: '千克',
          },
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -6,
            unit: '个',
          },
          { _id: { name: '钢管' }, name: '钢管', count: 2222.5, unit: '米' },
          { _id: { name: '扣件' }, name: '扣件', count: 1110, unit: '只' },
        ],
        freightGroup: [{ _id: null, freight: 0 }],
      },
      {
        name: '202201 月结算表',
        start: '2021-12-31T16:00:00.000Z',
        end: '2022-01-30T16:00:00.000Z',
        status: 'latest',
        history: [
          {
            _id: '盘扣立杆架',
            name: '盘扣立杆架',
            count: -6,
            days: 31,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: '钢管',
            name: '钢管',
            count: 2222.5,
            days: 31,
            price: 620.0774999999999,
            unit: '米',
            category: '租金',
            unitPrice: 0.009,
          },
          {
            _id: 'Φ48盘扣横杆',
            name: 'Φ48盘扣横杆',
            count: 95.2,
            days: 31,
            price: 19.1828,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
          {
            _id: '扣件',
            name: '扣件',
            count: 1110,
            days: 31,
            price: 189.255,
            unit: '只',
            category: '租金',
            unitPrice: 0.0055,
          },
          {
            _id: 'Φ48盘扣立杆',
            name: 'Φ48盘扣立杆',
            count: -1895.4000000000003,
            days: 31,
            price: -381.92310000000003,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
        ],
        list: [
          {
            _id: { year: 2022, month: 1, day: 7, name: '扣件', inOut: '出库' },
            outDate: '2022-01-07T03:41:15.327Z',
            number: 100,
            name: '扣件',
            count: 240,
            days: 25,
            inOut: '出库',
            unitPrice: 0.0055,
            price: 33,
            unit: '只',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 1, day: 7, name: '钢管', inOut: '出库' },
            outDate: '2022-01-07T03:41:15.327Z',
            number: 56,
            name: '钢管',
            count: 332,
            days: 25,
            inOut: '出库',
            unitPrice: 0.009,
            price: 74.69999999999999,
            unit: '米',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 1,
              day: 10,
              name: 'Φ48盘扣横杆',
              inOut: '出库',
            },
            outDate: '2022-01-10T01:21:32.932Z',
            number: 2205,
            name: 'Φ48盘扣横杆',
            count: 54.4,
            days: 22,
            inOut: '出库',
            unitPrice: 0.0065,
            price: 7.7791999999999994,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 1,
              day: 10,
              name: 'Φ48盘扣立杆',
              inOut: '出库',
            },
            outDate: '2022-01-10T01:21:32.932Z',
            number: 2106,
            name: 'Φ48盘扣立杆',
            count: 2368,
            days: 22,
            inOut: '出库',
            unitPrice: 0.0065,
            price: 338.62399999999997,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 1,
              day: 10,
              name: '盘扣上托',
              inOut: '出库',
            },
            outDate: '2022-01-10T01:21:32.932Z',
            number: 500,
            name: '盘扣上托',
            count: 18480,
            days: 22,
            inOut: '出库',
            unitPrice: 0.0065,
            price: 2642.64,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 1,
              day: 10,
              name: '盘扣下托',
              inOut: '出库',
            },
            outDate: '2022-01-10T01:21:32.932Z',
            number: 600,
            name: '盘扣下托',
            count: 1080,
            days: 22,
            inOut: '出库',
            unitPrice: 0.0065,
            price: 154.44,
            unit: '千克',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 1, day: 20, name: '钢管', inOut: '出库' },
            outDate: '2022-01-20T02:05:32.373Z',
            number: 41,
            name: '钢管',
            count: 1086,
            days: 12,
            inOut: '出库',
            unitPrice: 0.009,
            price: 117.28799999999998,
            unit: '米',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 1,
              day: 20,
              name: '钢管架',
              inOut: '出库',
            },
            outDate: '2022-01-20T02:05:32.373Z',
            number: 3000,
            name: '钢管架',
            count: 4,
            days: 12,
            inOut: '出库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
        ],
        group: { price: 3815.0633999999995 },
        nameGroup: [
          {
            _id: { name: '盘扣下托' },
            name: '盘扣下托',
            count: 1080,
            unit: '千克',
          },
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: 472.5999999999997,
            unit: '千克',
          },
          { _id: { name: '扣件' }, name: '扣件', count: 1350, unit: '只' },
          { _id: { name: '钢管' }, name: '钢管', count: 3640.5, unit: '米' },
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -6,
            unit: '个',
          },
          {
            _id: { name: 'Φ48盘扣横杆' },
            name: 'Φ48盘扣横杆',
            count: 149.6,
            unit: '千克',
          },
          { _id: { name: '钢管架' }, name: '钢管架', count: 4, unit: '个' },
          {
            _id: { name: '盘扣上托' },
            name: '盘扣上托',
            count: 18480,
            unit: '千克',
          },
        ],
        freightGroup: [{ _id: null, freight: 0 }],
        debug: [],
        _id: '6218479313e68937aca95215',
      },
      {
        name: '202202 月结算表',
        start: '2022-01-31T16:00:00.000Z',
        end: '2022-02-27T16:00:00.000Z',
        status: 'latest',
        history: [
          {
            _id: '盘扣下托',
            name: '盘扣下托',
            count: 1080,
            days: 28,
            price: 196.56,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
          {
            _id: '盘扣上托',
            name: '盘扣上托',
            count: 18480,
            days: 28,
            price: 3363.36,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
          {
            _id: '盘扣立杆架',
            name: '盘扣立杆架',
            count: -6,
            days: 28,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: '钢管',
            name: '钢管',
            count: 3640.5,
            days: 28,
            price: 917.4060000000001,
            unit: '米',
            category: '租金',
            unitPrice: 0.009,
          },
          {
            _id: 'Φ48盘扣横杆',
            name: 'Φ48盘扣横杆',
            count: 149.6,
            days: 28,
            price: 27.2272,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
          {
            _id: '扣件',
            name: '扣件',
            count: 1350,
            days: 28,
            price: 207.9,
            unit: '只',
            category: '租金',
            unitPrice: 0.0055,
          },
          {
            _id: '钢管架',
            name: '钢管架',
            count: 4,
            days: 28,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: 'Φ48盘扣立杆',
            name: 'Φ48盘扣立杆',
            count: 472.5999999999997,
            days: 28,
            price: 86.01319999999986,
            unit: '千克',
            category: '租金',
            unitPrice: 0.006499999999999994,
          },
        ],
        list: [
          {
            _id: {
              year: 2022,
              month: 2,
              day: 19,
              name: 'Φ48盘扣立杆',
              inOut: '出库',
            },
            outDate: '2022-02-19T00:27:29.060Z',
            number: 2106,
            name: 'Φ48盘扣立杆',
            count: 1655.9999999999998,
            days: 10,
            inOut: '出库',
            unitPrice: 0.0065,
            price: 107.63999999999997,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 2,
              day: 19,
              name: '盘扣立杆架',
              inOut: '出库',
            },
            outDate: '2022-02-19T00:27:29.060Z',
            number: 3004,
            name: '盘扣立杆架',
            count: 2,
            days: 10,
            inOut: '出库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 2,
              day: 19,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-02-19T02:02:11.494Z',
            number: 2104,
            name: 'Φ48盘扣立杆',
            count: -1939.7,
            days: 10,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -126.0805,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 2,
              day: 19,
              name: '盘扣下托',
              inOut: '入库',
            },
            outDate: '2022-02-19T02:02:11.494Z',
            number: 600,
            name: '盘扣下托',
            count: -1080,
            days: 10,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -70.19999999999999,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 2,
              day: 19,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-02-19T02:02:11.494Z',
            number: 3004,
            name: '盘扣立杆架',
            count: -2,
            days: 10,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
        ],
        group: { price: 4709.8259 },
        nameGroup: [
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: 188.8999999999994,
            unit: '千克',
          },
          { _id: { name: '扣件' }, name: '扣件', count: 1350, unit: '只' },
          { _id: { name: '钢管' }, name: '钢管', count: 3640.5, unit: '米' },
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -6,
            unit: '个',
          },
          {
            _id: { name: 'Φ48盘扣横杆' },
            name: 'Φ48盘扣横杆',
            count: 149.6,
            unit: '千克',
          },
          { _id: { name: '钢管架' }, name: '钢管架', count: 4, unit: '个' },
          {
            _id: { name: '盘扣上托' },
            name: '盘扣上托',
            count: 18480,
            unit: '千克',
          },
        ],
        freightGroup: [{ _id: null, freight: 0 }],
        debug: [],
        _id: '6218479c13e68937aca95217',
      },
      {
        name: '202203 月结算表',
        start: '2022-02-28T16:00:00.000Z',
        end: '2022-03-30T16:00:00.000Z',
        status: 'latest',
        history: [
          {
            _id: 'Φ48盘扣立杆',
            name: 'Φ48盘扣立杆',
            count: 188.8999999999994,
            days: 31,
            price: 38.0633499999999,
            unit: '千克',
            category: '租金',
            unitPrice: 0.006500000000000003,
          },
          {
            _id: '扣件',
            name: '扣件',
            count: 1350,
            days: 31,
            price: 230.17499999999998,
            unit: '只',
            category: '租金',
            unitPrice: 0.0055,
          },
          {
            _id: '钢管',
            name: '钢管',
            count: 3640.5,
            days: 31,
            price: 1015.6994999999998,
            unit: '米',
            category: '租金',
            unitPrice: 0.009,
          },
          {
            _id: '盘扣立杆架',
            name: '盘扣立杆架',
            count: -6,
            days: 31,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: 'Φ48盘扣横杆',
            name: 'Φ48盘扣横杆',
            count: 149.6,
            days: 31,
            price: 30.144399999999997,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
          {
            _id: '钢管架',
            name: '钢管架',
            count: 4,
            days: 31,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: '盘扣上托',
            name: '盘扣上托',
            count: 18480,
            days: 31,
            price: 3723.72,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
        ],
        list: [
          {
            _id: { year: 2022, month: 3, day: 5, name: '扣件', inOut: '出库' },
            outDate: '2022-03-05T01:50:45.694Z',
            number: 100,
            name: '扣件',
            count: 1620,
            days: 27,
            inOut: '出库',
            unitPrice: 0.0055,
            price: 240.57,
            unit: '只',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 3, day: 5, name: '钢管', inOut: '出库' },
            outDate: '2022-03-05T01:50:45.694Z',
            number: 26,
            name: '钢管',
            count: 1400,
            days: 27,
            inOut: '出库',
            unitPrice: 0.009,
            price: 340.19999999999993,
            unit: '米',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 3, day: 26, name: '扣件', inOut: '出库' },
            outDate: '2022-03-26T00:38:49.231Z',
            number: 100,
            name: '扣件',
            count: 120,
            days: 6,
            inOut: '出库',
            unitPrice: 0.0055,
            price: 3.9599999999999995,
            unit: '只',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 3, day: 26, name: '钢管', inOut: '出库' },
            outDate: '2022-03-26T00:38:49.231Z',
            number: 46,
            name: '钢管',
            count: 74,
            days: 6,
            inOut: '出库',
            unitPrice: 0.009,
            price: 3.9959999999999996,
            unit: '米',
            category: '租金',
          },
        ],
        group: { price: 5626.528249999999 },
        nameGroup: [
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: 188.8999999999994,
            unit: '千克',
          },
          { _id: { name: '扣件' }, name: '扣件', count: 3090, unit: '只' },
          { _id: { name: '钢管' }, name: '钢管', count: 5114.5, unit: '米' },
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -6,
            unit: '个',
          },
          {
            _id: { name: 'Φ48盘扣横杆' },
            name: 'Φ48盘扣横杆',
            count: 149.6,
            unit: '千克',
          },
          { _id: { name: '钢管架' }, name: '钢管架', count: 4, unit: '个' },
          {
            _id: { name: '盘扣上托' },
            name: '盘扣上托',
            count: 18480,
            unit: '千克',
          },
        ],
        freightGroup: [{ _id: null, freight: 0 }],
        debug: [],
        _id: '621847a813e68937aca95219',
      },
      {
        name: '202204 月结算表',
        start: '2022-03-31T16:00:00.000Z',
        end: '2022-04-29T16:00:00.000Z',
        status: 'latest',
        history: [
          {
            _id: '盘扣立杆架',
            name: '盘扣立杆架',
            count: -6,
            days: 30,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: '钢管',
            name: '钢管',
            count: 5114.5,
            days: 30,
            price: 1380.9149999999997,
            unit: '米',
            category: '租金',
            unitPrice: 0.009,
          },
          {
            _id: 'Φ48盘扣横杆',
            name: 'Φ48盘扣横杆',
            count: 149.6,
            days: 30,
            price: 29.171999999999997,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
          {
            _id: '扣件',
            name: '扣件',
            count: 3090,
            days: 30,
            price: 509.8499999999999,
            unit: '只',
            category: '租金',
            unitPrice: 0.0055,
          },
          {
            _id: '钢管架',
            name: '钢管架',
            count: 4,
            days: 30,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: 'Φ48盘扣立杆',
            name: 'Φ48盘扣立杆',
            count: 188.8999999999994,
            days: 30,
            price: 36.83549999999968,
            unit: '千克',
            category: '租金',
            unitPrice: 0.006499999999999964,
          },
          {
            _id: '盘扣上托',
            name: '盘扣上托',
            count: 18480,
            days: 30,
            price: 3603.5999999999995,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
        ],
        list: [],
        group: { price: 5560.372499999999 },
        nameGroup: [
          {
            _id: { name: '盘扣上托' },
            name: '盘扣上托',
            count: 18480,
            unit: '千克',
          },
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -6,
            unit: '个',
          },
          { _id: { name: '钢管' }, name: '钢管', count: 5114.5, unit: '米' },
          {
            _id: { name: 'Φ48盘扣横杆' },
            name: 'Φ48盘扣横杆',
            count: 149.6,
            unit: '千克',
          },
          { _id: { name: '扣件' }, name: '扣件', count: 3090, unit: '只' },
          { _id: { name: '钢管架' }, name: '钢管架', count: 4, unit: '个' },
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: 188.8999999999994,
            unit: '千克',
          },
        ],
        freightGroup: [],
        debug: [],
        _id: '6297212513e68937aca99a07',
      },
      {
        name: '202205 月结算表',
        start: '2022-04-30T16:00:00.000Z',
        end: '2022-05-30T16:00:00.000Z',
        status: 'latest',
        history: [
          {
            _id: '盘扣立杆架',
            name: '盘扣立杆架',
            count: -6,
            days: 31,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: 'Φ48盘扣横杆',
            name: 'Φ48盘扣横杆',
            count: 149.6,
            days: 31,
            price: 30.144399999999997,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
          {
            _id: '钢管架',
            name: '钢管架',
            count: 4,
            days: 31,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: '盘扣上托',
            name: '盘扣上托',
            count: 18480,
            days: 31,
            price: 3723.72,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
          {
            _id: 'Φ48盘扣立杆',
            name: 'Φ48盘扣立杆',
            count: 188.8999999999994,
            days: 31,
            price: 38.0633499999999,
            unit: '千克',
            category: '租金',
            unitPrice: 0.006500000000000003,
          },
          {
            _id: '扣件',
            name: '扣件',
            count: 3090,
            days: 31,
            price: 526.8449999999999,
            unit: '只',
            category: '租金',
            unitPrice: 0.0055,
          },
          {
            _id: '钢管',
            name: '钢管',
            count: 5114.5,
            days: 31,
            price: 1426.9454999999998,
            unit: '米',
            category: '租金',
            unitPrice: 0.009,
          },
        ],
        list: [],
        group: { price: 5745.71825 },
        nameGroup: [
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: 188.8999999999994,
            unit: '千克',
          },
          { _id: { name: '扣件' }, name: '扣件', count: 3090, unit: '只' },
          { _id: { name: '钢管' }, name: '钢管', count: 5114.5, unit: '米' },
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -6,
            unit: '个',
          },
          {
            _id: { name: 'Φ48盘扣横杆' },
            name: 'Φ48盘扣横杆',
            count: 149.6,
            unit: '千克',
          },
          { _id: { name: '钢管架' }, name: '钢管架', count: 4, unit: '个' },
          {
            _id: { name: '盘扣上托' },
            name: '盘扣上托',
            count: 18480,
            unit: '千克',
          },
        ],
        freightGroup: [],
        debug: [],
        _id: '6297213113e68937aca99a09',
      },
      {
        name: '202206 月结算表',
        start: '2022-05-31T16:00:00.000Z',
        end: '2022-06-29T16:00:00.000Z',
        status: 'latest',
        history: [
          {
            _id: 'Φ48盘扣立杆',
            name: 'Φ48盘扣立杆',
            count: 188.8999999999994,
            days: 30,
            price: 36.83549999999968,
            unit: '千克',
            category: '租金',
            unitPrice: 0.006499999999999964,
          },
          {
            _id: '扣件',
            name: '扣件',
            count: 3090,
            days: 30,
            price: 509.8499999999999,
            unit: '只',
            category: '租金',
            unitPrice: 0.0055,
          },
          {
            _id: '钢管',
            name: '钢管',
            count: 5114.5,
            days: 30,
            price: 1380.9149999999997,
            unit: '米',
            category: '租金',
            unitPrice: 0.009,
          },
          {
            _id: 'Φ48盘扣横杆',
            name: 'Φ48盘扣横杆',
            count: 149.6,
            days: 30,
            price: 29.171999999999997,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
          {
            _id: '盘扣立杆架',
            name: '盘扣立杆架',
            count: -6,
            days: 30,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: '钢管架',
            name: '钢管架',
            count: 4,
            days: 30,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: '盘扣上托',
            name: '盘扣上托',
            count: 18480,
            days: 30,
            price: 3603.5999999999995,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
        ],
        list: [],
        group: { price: 5560.372499999999 },
        nameGroup: [
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -6,
            unit: '个',
          },
          { _id: { name: '钢管' }, name: '钢管', count: 5114.5, unit: '米' },
          {
            _id: { name: 'Φ48盘扣横杆' },
            name: 'Φ48盘扣横杆',
            count: 149.6,
            unit: '千克',
          },
          { _id: { name: '扣件' }, name: '扣件', count: 3090, unit: '只' },
          { _id: { name: '钢管架' }, name: '钢管架', count: 4, unit: '个' },
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: 188.8999999999994,
            unit: '千克',
          },
          {
            _id: { name: '盘扣上托' },
            name: '盘扣上托',
            count: 18480,
            unit: '千克',
          },
        ],
        freightGroup: [],
        debug: [],
        _id: '62c5382913e68937aca9be96',
      },
      {
        name: '202207 月结算表',
        start: '2022-06-30T16:00:00.000Z',
        end: '2022-07-30T16:00:00.000Z',
        status: 'latest',
        history: [
          {
            _id: '盘扣立杆架',
            name: '盘扣立杆架',
            count: -6,
            days: 31,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: '钢管',
            name: '钢管',
            count: 5114.5,
            days: 31,
            price: 1426.9454999999998,
            unit: '米',
            category: '租金',
            unitPrice: 0.009,
          },
          {
            _id: 'Φ48盘扣横杆',
            name: 'Φ48盘扣横杆',
            count: 149.6,
            days: 31,
            price: 30.144399999999997,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
          {
            _id: '扣件',
            name: '扣件',
            count: 3090,
            days: 31,
            price: 526.8449999999999,
            unit: '只',
            category: '租金',
            unitPrice: 0.0055,
          },
          {
            _id: '钢管架',
            name: '钢管架',
            count: 4,
            days: 31,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: 'Φ48盘扣立杆',
            name: 'Φ48盘扣立杆',
            count: 188.8999999999994,
            days: 31,
            price: 38.0633499999999,
            unit: '千克',
            category: '租金',
            unitPrice: 0.006500000000000003,
          },
          {
            _id: '盘扣上托',
            name: '盘扣上托',
            count: 18480,
            days: 31,
            price: 3723.72,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
        ],
        list: [
          {
            _id: { year: 2022, month: 7, day: 18, name: '扣件', inOut: '入库' },
            outDate: '2022-07-18T07:10:07.822Z',
            number: 100,
            name: '扣件',
            count: -2139,
            days: 14,
            inOut: '入库',
            unitPrice: 0.0055,
            price: -164.70299999999997,
            unit: '只',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 7, day: 18, name: '钢管', inOut: '入库' },
            outDate: '2022-07-18T07:10:07.822Z',
            number: 26,
            name: '钢管',
            count: -1059,
            days: 14,
            inOut: '入库',
            unitPrice: 0.009,
            price: -133.434,
            unit: '米',
            category: '租金',
          },
        ],
        group: { price: 5447.581249999999 },
        nameGroup: [
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -6,
            unit: '个',
          },
          {
            _id: { name: 'Φ48盘扣横杆' },
            name: 'Φ48盘扣横杆',
            count: 149.6,
            unit: '千克',
          },
          { _id: { name: '钢管' }, name: '钢管', count: 4055.5, unit: '米' },
          { _id: { name: '扣件' }, name: '扣件', count: 951, unit: '只' },
          { _id: { name: '钢管架' }, name: '钢管架', count: 4, unit: '个' },
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: 188.8999999999994,
            unit: '千克',
          },
          {
            _id: { name: '盘扣上托' },
            name: '盘扣上托',
            count: 18480,
            unit: '千克',
          },
        ],
        freightGroup: [{ _id: null, freight: 0 }],
        debug: [],
        _id: '62c5383313e68937aca9be98',
      },
      {
        name: '202208 月结算表',
        start: '2022-07-31T16:00:00.000Z',
        end: '2022-08-30T16:00:00.000Z',
        status: 'latest',
        history: [
          {
            _id: '盘扣上托',
            name: '盘扣上托',
            count: 18480,
            days: 31,
            price: 3723.72,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
          {
            _id: '扣件',
            name: '扣件',
            count: 951,
            days: 31,
            price: 162.14550000000003,
            unit: '只',
            category: '租金',
            unitPrice: 0.005500000000000001,
          },
          {
            _id: '钢管',
            name: '钢管',
            count: 4055.5,
            days: 31,
            price: 1131.4844999999998,
            unit: '米',
            category: '租金',
            unitPrice: 0.009,
          },
          {
            _id: '盘扣立杆架',
            name: '盘扣立杆架',
            count: -6,
            days: 31,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: 'Φ48盘扣横杆',
            name: 'Φ48盘扣横杆',
            count: 149.6,
            days: 31,
            price: 30.144399999999997,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
          {
            _id: '钢管架',
            name: '钢管架',
            count: 4,
            days: 31,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: 'Φ48盘扣立杆',
            name: 'Φ48盘扣立杆',
            count: 188.8999999999994,
            days: 31,
            price: 38.0633499999999,
            unit: '千克',
            category: '租金',
            unitPrice: 0.006500000000000003,
          },
        ],
        list: [
          {
            _id: {
              year: 2022,
              month: 8,
              day: 18,
              name: 'Φ48盘扣横杆',
              inOut: '入库',
            },
            outDate: '2022-08-18T03:22:41.516Z',
            number: 2205,
            name: 'Φ48盘扣横杆',
            count: -149.6,
            days: 14,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -13.613599999999998,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 8,
              day: 18,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-08-18T03:22:41.516Z',
            number: 2106,
            name: 'Φ48盘扣立杆',
            count: -6801.4,
            days: 14,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -618.9273999999999,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 8,
              day: 18,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-08-18T03:22:41.516Z',
            number: 3004,
            name: '盘扣立杆架',
            count: -12,
            days: 14,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 8,
              day: 31,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-08-31T01:05:43.720Z',
            number: 2106,
            name: 'Φ48盘扣立杆',
            count: -1110.8999999999999,
            days: 1,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -7.220849999999999,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 8,
              day: 31,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-08-31T01:05:43.720Z',
            number: 3004,
            name: '盘扣立杆架',
            count: -2,
            days: 1,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
        ],
        group: { price: 4445.795900000001 },
        nameGroup: [
          {
            _id: { name: '盘扣上托' },
            name: '盘扣上托',
            count: 18480,
            unit: '千克',
          },
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -20,
            unit: '个',
          },
          { _id: { name: '钢管' }, name: '钢管', count: 4055.5, unit: '米' },
          { _id: { name: '扣件' }, name: '扣件', count: 951, unit: '只' },
          { _id: { name: '钢管架' }, name: '钢管架', count: 4, unit: '个' },
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: -7723.4,
            unit: '千克',
          },
        ],
        freightGroup: [{ _id: null, freight: 0 }],
        debug: [],
        _id: '62f07b6213e68937aca9e169',
      },
      {
        name: '202209 月结算表',
        start: '2022-08-31T16:00:00.000Z',
        end: '2022-09-29T16:00:00.000Z',
        status: 'latest',
        history: [
          {
            _id: 'Φ48盘扣立杆',
            name: 'Φ48盘扣立杆',
            count: -7723.4,
            days: 30,
            price: -1506.0629999999999,
            unit: '千克',
            category: '租金',
            unitPrice: 0.006500000000000001,
          },
          {
            _id: '扣件',
            name: '扣件',
            count: 951,
            days: 30,
            price: 156.915,
            unit: '只',
            category: '租金',
            unitPrice: 0.0055,
          },
          {
            _id: '钢管',
            name: '钢管',
            count: 4055.5,
            days: 30,
            price: 1094.985,
            unit: '米',
            category: '租金',
            unitPrice: 0.009,
          },
          {
            _id: '盘扣立杆架',
            name: '盘扣立杆架',
            count: -20,
            days: 30,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: '钢管架',
            name: '钢管架',
            count: 4,
            days: 30,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: '盘扣上托',
            name: '盘扣上托',
            count: 18480,
            days: 30,
            price: 3603.5999999999995,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
        ],
        list: [
          {
            _id: { year: 2022, month: 9, day: 8, name: '扣件', inOut: '出库' },
            outDate: '2022-09-08T09:04:36.106Z',
            number: 100,
            name: '扣件',
            count: 600,
            days: 23,
            inOut: '出库',
            unitPrice: 0.0055,
            price: 75.89999999999999,
            unit: '只',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 9, day: 8, name: '钢管', inOut: '出库' },
            outDate: '2022-09-08T09:04:36.106Z',
            number: 6,
            name: '钢管',
            count: 200,
            days: 23,
            inOut: '出库',
            unitPrice: 0.009,
            price: 41.4,
            unit: '米',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 9,
              day: 14,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-09-14T00:32:33.558Z',
            number: 2106,
            name: 'Φ48盘扣立杆',
            count: -1051.1,
            days: 17,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -116.14654999999999,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 9,
              day: 14,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-09-14T00:32:33.558Z',
            number: 3004,
            name: '盘扣立杆架',
            count: -2,
            days: 17,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 9,
              day: 25,
              name: '盘扣上托',
              inOut: '入库',
            },
            outDate: '2022-09-25T06:34:07.741Z',
            number: null,
            name: '盘扣上托',
            count: -5760,
            days: 6,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -224.64,
            unit: '千克',
            category: '租金',
          },
        ],
        group: { price: 3125.95045 },
        nameGroup: [
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: -8774.5,
            unit: '千克',
          },
          { _id: { name: '扣件' }, name: '扣件', count: 1551, unit: '只' },
          { _id: { name: '钢管' }, name: '钢管', count: 4255.5, unit: '米' },
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -22,
            unit: '个',
          },
          { _id: { name: '钢管架' }, name: '钢管架', count: 4, unit: '个' },
          {
            _id: { name: '盘扣上托' },
            name: '盘扣上托',
            count: 12720,
            unit: '千克',
          },
        ],
        freightGroup: [{ _id: null, freight: 0 }],
        debug: [],
        _id: '6315b16e13e68937acaa0609',
      },
      {
        name: '202210 月结算表',
        start: '2022-09-30T16:00:00.000Z',
        end: '2022-10-30T16:00:00.000Z',
        status: 'latest',
        history: [
          {
            _id: '盘扣上托',
            name: '盘扣上托',
            count: 12720,
            days: 31,
            price: 2563.08,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
          {
            _id: '扣件',
            name: '扣件',
            count: 1551,
            days: 31,
            price: 264.44550000000004,
            unit: '只',
            category: '租金',
            unitPrice: 0.0055000000000000005,
          },
          {
            _id: '钢管',
            name: '钢管',
            count: 4255.5,
            days: 31,
            price: 1187.2844999999998,
            unit: '米',
            category: '租金',
            unitPrice: 0.008999999999999998,
          },
          {
            _id: '盘扣立杆架',
            name: '盘扣立杆架',
            count: -22,
            days: 31,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: '钢管架',
            name: '钢管架',
            count: 4,
            days: 31,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: 'Φ48盘扣立杆',
            name: 'Φ48盘扣立杆',
            count: -8774.5,
            days: 31,
            price: -1768.0617499999998,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
        ],
        list: [
          {
            _id: {
              year: 2022,
              month: 10,
              day: 3,
              name: 'Φ48盘扣横杆',
              inOut: '入库',
            },
            outDate: '2022-10-03T07:58:04.286Z',
            number: null,
            name: 'Φ48盘扣横杆',
            count: -11825.800000000001,
            days: 29,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -2229.1633,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 3,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-10-03T07:58:04.286Z',
            number: null,
            name: 'Φ48盘扣立杆',
            count: -1285.6999999999998,
            days: 29,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -242.35444999999999,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 3,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-10-03T07:58:04.286Z',
            number: null,
            name: '盘扣立杆架',
            count: -26,
            days: 29,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 12,
              name: '扣件',
              inOut: '入库',
            },
            outDate: '2022-10-12T08:07:10.171Z',
            number: null,
            name: '扣件',
            count: -1317,
            days: 20,
            inOut: '入库',
            unitPrice: 0.0055,
            price: -144.87,
            unit: '只',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 12,
              name: '钢管',
              inOut: '入库',
            },
            outDate: '2022-10-12T08:07:10.171Z',
            number: null,
            name: '钢管',
            count: -2263.5,
            days: 20,
            inOut: '入库',
            unitPrice: 0.009,
            price: -407.43,
            unit: '米',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 16,
              name: '盘扣上托',
              inOut: '入库',
            },
            outDate: '2022-10-16T01:46:19.160Z',
            number: null,
            name: '盘扣上托',
            count: -3840,
            days: 16,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -399.35999999999996,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 16,
              name: '钢管架',
              inOut: '入库',
            },
            outDate: '2022-10-16T01:46:19.160Z',
            number: null,
            name: '钢管架',
            count: -2,
            days: 16,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 23,
              name: '扣件',
              inOut: '入库',
            },
            outDate: '2022-10-23T02:52:41.238Z',
            number: null,
            name: '扣件',
            count: -603,
            days: 9,
            inOut: '入库',
            unitPrice: 0.0055,
            price: -29.8485,
            unit: '只',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 23,
              name: '盘扣上托',
              inOut: '入库',
            },
            outDate: '2022-10-23T02:52:41.238Z',
            number: null,
            name: '盘扣上托',
            count: -2400,
            days: 9,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -140.4,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 23,
              name: '钢管',
              inOut: '入库',
            },
            outDate: '2022-10-23T02:52:41.238Z',
            number: null,
            name: '钢管',
            count: -179.6,
            days: 9,
            inOut: '入库',
            unitPrice: 0.009,
            price: -14.5476,
            unit: '米',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 23,
              name: 'Φ48盘扣横杆',
              inOut: '入库',
            },
            outDate: '2022-10-23T09:17:39.037Z',
            number: null,
            name: 'Φ48盘扣横杆',
            count: -9072,
            days: 9,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -530.712,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 23,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-10-23T09:17:39.037Z',
            number: null,
            name: '盘扣立杆架',
            count: -20,
            days: 9,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 29,
              name: 'Φ33盘扣斜杆',
              inOut: '入库',
            },
            outDate: '2022-10-29T03:48:07.171Z',
            number: null,
            name: 'Φ33盘扣斜杆',
            count: -1575,
            days: 3,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -30.7125,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 29,
              name: 'Φ48盘扣横杆',
              inOut: '入库',
            },
            outDate: '2022-10-29T03:48:07.171Z',
            number: null,
            name: 'Φ48盘扣横杆',
            count: -26643.600000000002,
            days: 3,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -519.5502,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 29,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-10-29T03:48:07.171Z',
            number: null,
            name: '盘扣立杆架',
            count: -38,
            days: 3,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 29,
              name: '扣件',
              inOut: '出库',
            },
            outDate: '2022-10-29T04:24:47.520Z',
            number: null,
            name: '扣件',
            count: 1012,
            days: 3,
            inOut: '出库',
            unitPrice: 0.0055,
            price: 16.698,
            unit: '只',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 29,
              name: '扣件',
              inOut: '入库',
            },
            outDate: '2022-10-29T06:48:31.368Z',
            number: null,
            name: '扣件',
            count: -509,
            days: 3,
            inOut: '入库',
            unitPrice: 0.0055,
            price: -8.3985,
            unit: '只',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 29,
              name: '盘扣上托',
              inOut: '入库',
            },
            outDate: '2022-10-29T06:48:31.368Z',
            number: null,
            name: '盘扣上托',
            count: -3360,
            days: 3,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -65.52,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 29,
              name: '钢管',
              inOut: '入库',
            },
            outDate: '2022-10-29T06:48:31.368Z',
            number: null,
            name: '钢管',
            count: -590.6,
            days: 3,
            inOut: '入库',
            unitPrice: 0.009,
            price: -15.946199999999997,
            unit: '米',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 31,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-10-31T07:44:59.738Z',
            number: null,
            name: 'Φ48盘扣立杆',
            count: -7430.15,
            days: 1,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -48.295975,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 31,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-10-31T07:44:59.738Z',
            number: null,
            name: '盘扣立杆架',
            count: -12,
            days: 1,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
        ],
        group: { price: -2563.6629750000006 },
        nameGroup: [
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: -17490.35,
            unit: '千克',
          },
          { _id: { name: '扣件' }, name: '扣件', count: 134, unit: '只' },
          { _id: { name: '钢管' }, name: '钢管', count: 1221.8, unit: '米' },
          {
            _id: { name: 'Φ48盘扣横杆' },
            name: 'Φ48盘扣横杆',
            count: -47541.40000000001,
            unit: '千克',
          },
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -118,
            unit: '个',
          },
          { _id: { name: '钢管架' }, name: '钢管架', count: 2, unit: '个' },
          {
            _id: { name: 'Φ33盘扣斜杆' },
            name: 'Φ33盘扣斜杆',
            count: -1575,
            unit: '千克',
          },
          {
            _id: { name: '盘扣上托' },
            name: '盘扣上托',
            count: 3120,
            unit: '千克',
          },
        ],
        debug: [],
        _id: '634677b19f0e7adc335af639',
      },
      {
        name: '202211 月结算表',
        start: '2022-10-31T16:00:00.000Z',
        end: '2022-11-29T16:00:00.000Z',
        status: 'latest',
        history: [
          {
            _id: 'Φ48盘扣立杆',
            name: 'Φ48盘扣立杆',
            count: -17490.35,
            days: 30,
            price: -3410.6182499999995,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
          {
            _id: '盘扣上托',
            name: '盘扣上托',
            count: 3120,
            days: 30,
            price: 608.3999999999999,
            unit: '千克',
            category: '租金',
            unitPrice: 0.006499999999999998,
          },
          {
            _id: 'Φ33盘扣斜杆',
            name: 'Φ33盘扣斜杆',
            count: -1575,
            days: 30,
            price: -307.12499999999994,
            unit: '千克',
            category: '租金',
            unitPrice: 0.006499999999999998,
          },
          {
            _id: '扣件',
            name: '扣件',
            count: 134,
            days: 30,
            price: 22.110000000000014,
            unit: '只',
            category: '租金',
            unitPrice: 0.005500000000000003,
          },
          {
            _id: '盘扣立杆架',
            name: '盘扣立杆架',
            count: -118,
            days: 30,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: 'Φ48盘扣横杆',
            name: 'Φ48盘扣横杆',
            count: -47541.40000000001,
            days: 30,
            price: -9270.573,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
          {
            _id: '钢管',
            name: '钢管',
            count: 1221.8,
            days: 30,
            price: 329.88599999999997,
            unit: '米',
            category: '租金',
            unitPrice: 0.009,
          },
          {
            _id: '钢管架',
            name: '钢管架',
            count: 2,
            days: 30,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
        ],
        list: [
          {
            _id: {
              year: 2022,
              month: 11,
              day: 1,
              name: 'Φ48盘扣横杆',
              inOut: '入库',
            },
            outDate: '2022-11-01T06:33:34.095Z',
            number: null,
            name: 'Φ48盘扣横杆',
            count: -18144,
            days: 30,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -3538.08,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 1,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-11-01T06:33:34.095Z',
            number: null,
            name: 'Φ48盘扣立杆',
            count: -16285.15,
            days: 30,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -3175.60425,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 1,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-11-01T06:33:34.095Z',
            number: null,
            name: '盘扣立杆架',
            count: -74,
            days: 30,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 2,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-11-02T05:37:40.171Z',
            number: null,
            name: 'Φ48盘扣立杆',
            count: -862.65,
            days: 29,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -162.609525,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 2,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-11-02T05:37:40.171Z',
            number: null,
            name: '盘扣立杆架',
            count: -2,
            days: 29,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 8,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-11-08T08:04:23.119Z',
            number: null,
            name: 'Φ48盘扣立杆',
            count: -901.6999999999999,
            days: 23,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -134.80415,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 8,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-11-08T08:04:23.119Z',
            number: null,
            name: '盘扣立杆架',
            count: -2,
            days: 23,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 29,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-11-29T03:23:48.635Z',
            number: null,
            name: 'Φ48盘扣立杆',
            count: -2592.1,
            days: 2,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -33.6973,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 29,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-11-29T03:23:48.635Z',
            number: null,
            name: '盘扣立杆架',
            count: -4,
            days: 2,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
        ],
        group: { price: -19072.715474999997 },
        nameGroup: [
          { _id: { name: '钢管' }, name: '钢管', count: 1221.8, unit: '米' },
          {
            _id: { name: 'Φ48盘扣横杆' },
            name: 'Φ48盘扣横杆',
            count: -65685.40000000001,
            unit: '千克',
          },
          { _id: { name: '钢管架' }, name: '钢管架', count: 2, unit: '个' },
          {
            _id: { name: '盘扣上托' },
            name: '盘扣上托',
            count: 3120,
            unit: '千克',
          },
          {
            _id: { name: 'Φ33盘扣斜杆' },
            name: 'Φ33盘扣斜杆',
            count: -1575,
            unit: '千克',
          },
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: -38131.95,
            unit: '千克',
          },
          { _id: { name: '扣件' }, name: '扣件', count: 134, unit: '只' },
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -200,
            unit: '个',
          },
        ],
        debug: [],
        _id: '639049636ee855fd39129016',
      },
      {
        name: '202212   月结算表',
        start: '2022-11-30T16:00:00.000Z',
        end: '2022-12-30T16:00:00.000Z',
        status: 'latest',
        history: [
          {
            _id: 'Φ33盘扣斜杆',
            name: 'Φ33盘扣斜杆',
            count: -1575,
            days: 31,
            price: -317.36249999999995,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
          {
            _id: '盘扣上托',
            name: '盘扣上托',
            count: 3120,
            days: 31,
            price: 628.6800000000001,
            unit: '千克',
            category: '租金',
            unitPrice: 0.006500000000000001,
          },
          {
            _id: '扣件',
            name: '扣件',
            count: 134,
            days: 31,
            price: 22.847000000000037,
            unit: '只',
            category: '租金',
            unitPrice: 0.005500000000000008,
          },
          {
            _id: '钢管',
            name: '钢管',
            count: 1221.8,
            days: 31,
            price: 340.88219999999995,
            unit: '米',
            category: '租金',
            unitPrice: 0.009,
          },
          {
            _id: '盘扣立杆架',
            name: '盘扣立杆架',
            count: -200,
            days: 31,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: 'Φ48盘扣横杆',
            name: 'Φ48盘扣横杆',
            count: -65685.40000000001,
            days: 31,
            price: -13235.6081,
            unit: '千克',
            category: '租金',
            unitPrice: 0.006499999999999999,
          },
          {
            _id: '钢管架',
            name: '钢管架',
            count: 2,
            days: 31,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: 'Φ48盘扣立杆',
            name: 'Φ48盘扣立杆',
            count: -38131.95,
            days: 31,
            price: -7683.587924999999,
            unit: '千克',
            category: '租金',
            unitPrice: 0.0065,
          },
        ],
        list: [
          {
            _id: {
              year: 2022,
              month: 12,
              day: 8,
              name: '盘扣上托',
              inOut: '入库',
            },
            outDate: '2022-12-08T06:44:07.941Z',
            number: null,
            name: '盘扣上托',
            count: -1440,
            days: 24,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -224.64,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 11,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-12-11T07:50:44.666Z',
            number: null,
            name: 'Φ48盘扣立杆',
            count: -1481.1999999999998,
            days: 21,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -202.18379999999996,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 11,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-12-11T07:50:44.666Z',
            number: null,
            name: '盘扣立杆架',
            count: -2,
            days: 21,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 17,
              name: 'Φ33盘扣斜杆',
              inOut: '出库',
            },
            outDate: '2022-12-17T00:52:57.227Z',
            number: null,
            name: 'Φ33盘扣斜杆',
            count: 6552,
            days: 15,
            inOut: '出库',
            unitPrice: 0.0065,
            price: 638.82,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 17,
              name: '盘扣立杆架',
              inOut: '出库',
            },
            outDate: '2022-12-17T00:52:57.227Z',
            number: null,
            name: '盘扣立杆架',
            count: 8,
            days: 15,
            inOut: '出库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 20,
              name: 'Φ48盘扣横杆',
              inOut: '入库',
            },
            outDate: '2022-12-20T05:09:09.838Z',
            number: null,
            name: 'Φ48盘扣横杆',
            count: -924,
            days: 12,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -72.07199999999999,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 26,
              name: '盘扣上托',
              inOut: '入库',
            },
            outDate: '2022-12-26T07:29:13.173Z',
            number: null,
            name: '盘扣上托',
            count: -96,
            days: 6,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -3.7439999999999998,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 28,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-12-28T07:27:38.802Z',
            number: null,
            name: 'Φ48盘扣立杆',
            count: -1107.6,
            days: 4,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -28.797599999999996,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 28,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-12-28T07:27:38.802Z',
            number: null,
            name: '盘扣立杆架',
            count: -2,
            days: 4,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
        ],
        group: { price: -20136.766724999998 },
        nameGroup: [
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: -40720.75,
            unit: '千克',
          },
          { _id: { name: '扣件' }, name: '扣件', count: 134, unit: '只' },
          {
            _id: { name: 'Φ48盘扣横杆' },
            name: 'Φ48盘扣横杆',
            count: -66609.40000000001,
            unit: '千克',
          },
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -196,
            unit: '个',
          },
          { _id: { name: '钢管' }, name: '钢管', count: 1221.8, unit: '米' },
          { _id: { name: '钢管架' }, name: '钢管架', count: 2, unit: '个' },
          {
            _id: { name: 'Φ33盘扣斜杆' },
            name: 'Φ33盘扣斜杆',
            count: 4977,
            unit: '千克',
          },
          {
            _id: { name: '盘扣上托' },
            name: '盘扣上托',
            count: 1584,
            unit: '千克',
          },
        ],
        debug: [],
        _id: '63b683a04e2d809c871e9a67',
      },
      {
        name: '2022年  结算表',
        start: '2021-12-31T16:00:00.000Z',
        end: '2022-12-30T16:00:00.000Z',
        status: 'latest',
        history: [
          {
            _id: 'Φ48盘扣立杆',
            name: 'Φ48盘扣立杆',
            count: -1895.4000000000003,
            days: 365,
            price: -3459.1050000000014,
            unit: '千克',
            category: '租金',
            unitPrice: 0.005000000000000001,
          },
          {
            _id: 'Φ48盘扣横杆',
            name: 'Φ48盘扣横杆',
            count: 95.2,
            days: 365,
            price: 173.74,
            unit: '千克',
            category: '租金',
            unitPrice: 0.005,
          },
          {
            _id: '钢管',
            name: '钢管',
            count: 2222.5,
            days: 365,
            price: 5272.88125,
            unit: '米',
            category: '租金',
            unitPrice: 0.006500000000000001,
          },
          {
            _id: '盘扣立杆架',
            name: '盘扣立杆架',
            count: -6,
            days: 365,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: '扣件',
            name: '扣件',
            count: 1110,
            days: 365,
            price: 1215.45,
            unit: '只',
            category: '租金',
            unitPrice: 0.003,
          },
        ],
        list: [
          {
            _id: { year: 2022, month: 1, day: 7, name: '扣件', inOut: '出库' },
            outDate: '2022-01-07T03:41:15.327Z',
            number: 100,
            name: '扣件',
            count: 240,
            days: 359,
            inOut: '出库',
            unitPrice: 0.003,
            price: 258.48,
            unit: '只',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 1, day: 7, name: '钢管', inOut: '出库' },
            outDate: '2022-01-07T03:41:15.327Z',
            number: 56,
            name: '钢管',
            count: 332,
            days: 359,
            inOut: '出库',
            unitPrice: 0.0065,
            price: 774.722,
            unit: '米',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 1,
              day: 10,
              name: 'Φ48盘扣横杆',
              inOut: '出库',
            },
            outDate: '2022-01-10T01:21:32.932Z',
            number: 2205,
            name: 'Φ48盘扣横杆',
            count: 54.4,
            days: 356,
            inOut: '出库',
            unitPrice: 0.005,
            price: 96.83200000000001,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 1,
              day: 10,
              name: 'Φ48盘扣立杆',
              inOut: '出库',
            },
            outDate: '2022-01-10T01:21:32.932Z',
            number: 2106,
            name: 'Φ48盘扣立杆',
            count: 2368,
            days: 356,
            inOut: '出库',
            unitPrice: 0.005,
            price: 4215.04,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 1,
              day: 10,
              name: '盘扣上托',
              inOut: '出库',
            },
            outDate: '2022-01-10T01:21:32.932Z',
            number: 500,
            name: '盘扣上托',
            count: 18480,
            days: 356,
            inOut: '出库',
            unitPrice: 0.005,
            price: 32894.4,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 1,
              day: 10,
              name: '盘扣下托',
              inOut: '出库',
            },
            outDate: '2022-01-10T01:21:32.932Z',
            number: 600,
            name: '盘扣下托',
            count: 1080,
            days: 356,
            inOut: '出库',
            unitPrice: 0.005,
            price: 1922.4,
            unit: '千克',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 1, day: 20, name: '钢管', inOut: '出库' },
            outDate: '2022-01-20T02:05:32.373Z',
            number: 41,
            name: '钢管',
            count: 1086,
            days: 346,
            inOut: '出库',
            unitPrice: 0.0065,
            price: 2442.4139999999998,
            unit: '米',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 1,
              day: 20,
              name: '钢管架',
              inOut: '出库',
            },
            outDate: '2022-01-20T02:05:32.373Z',
            number: 3000,
            name: '钢管架',
            count: 4,
            days: 346,
            inOut: '出库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 2,
              day: 19,
              name: 'Φ48盘扣立杆',
              inOut: '出库',
            },
            outDate: '2022-02-19T00:27:29.060Z',
            number: 2106,
            name: 'Φ48盘扣立杆',
            count: 1655.9999999999998,
            days: 316,
            inOut: '出库',
            unitPrice: 0.005,
            price: 2616.48,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 2,
              day: 19,
              name: '盘扣立杆架',
              inOut: '出库',
            },
            outDate: '2022-02-19T00:27:29.060Z',
            number: 3004,
            name: '盘扣立杆架',
            count: 2,
            days: 316,
            inOut: '出库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 2,
              day: 19,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-02-19T02:02:11.494Z',
            number: 2104,
            name: 'Φ48盘扣立杆',
            count: -1939.7,
            days: 316,
            inOut: '入库',
            unitPrice: 0.005,
            price: -3064.726,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 2,
              day: 19,
              name: '盘扣下托',
              inOut: '入库',
            },
            outDate: '2022-02-19T02:02:11.494Z',
            number: 600,
            name: '盘扣下托',
            count: -1080,
            days: 316,
            inOut: '入库',
            unitPrice: 0.005,
            price: -1706.4,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 2,
              day: 19,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-02-19T02:02:11.494Z',
            number: 3004,
            name: '盘扣立杆架',
            count: -2,
            days: 316,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 3, day: 5, name: '扣件', inOut: '出库' },
            outDate: '2022-03-05T01:50:45.694Z',
            number: 100,
            name: '扣件',
            count: 1620,
            days: 302,
            inOut: '出库',
            unitPrice: 0.003,
            price: 1467.7199999999998,
            unit: '只',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 3, day: 5, name: '钢管', inOut: '出库' },
            outDate: '2022-03-05T01:50:45.694Z',
            number: 26,
            name: '钢管',
            count: 1400,
            days: 302,
            inOut: '出库',
            unitPrice: 0.0065,
            price: 2748.2,
            unit: '米',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 3, day: 26, name: '扣件', inOut: '出库' },
            outDate: '2022-03-26T00:38:49.231Z',
            number: 100,
            name: '扣件',
            count: 120,
            days: 281,
            inOut: '出库',
            unitPrice: 0.003,
            price: 101.16,
            unit: '只',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 3, day: 26, name: '钢管', inOut: '出库' },
            outDate: '2022-03-26T00:38:49.231Z',
            number: 46,
            name: '钢管',
            count: 74,
            days: 281,
            inOut: '出库',
            unitPrice: 0.0065,
            price: 135.161,
            unit: '米',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 7, day: 18, name: '扣件', inOut: '入库' },
            outDate: '2022-07-18T07:10:07.822Z',
            number: 100,
            name: '扣件',
            count: -2139,
            days: 167,
            inOut: '入库',
            unitPrice: 0.003,
            price: -1071.6390000000001,
            unit: '只',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 7, day: 18, name: '钢管', inOut: '入库' },
            outDate: '2022-07-18T07:10:07.822Z',
            number: 26,
            name: '钢管',
            count: -1059,
            days: 167,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -1149.5445,
            unit: '米',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 8,
              day: 18,
              name: 'Φ48盘扣横杆',
              inOut: '入库',
            },
            outDate: '2022-08-18T03:22:41.516Z',
            number: 2205,
            name: 'Φ48盘扣横杆',
            count: -149.6,
            days: 136,
            inOut: '入库',
            unitPrice: 0.005,
            price: -101.728,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 8,
              day: 18,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-08-18T03:22:41.516Z',
            number: 2106,
            name: 'Φ48盘扣立杆',
            count: -6801.4,
            days: 136,
            inOut: '入库',
            unitPrice: 0.005,
            price: -4624.951999999999,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 8,
              day: 18,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-08-18T03:22:41.516Z',
            number: 3004,
            name: '盘扣立杆架',
            count: -12,
            days: 136,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 8,
              day: 31,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-08-31T01:05:43.720Z',
            number: 2106,
            name: 'Φ48盘扣立杆',
            count: -1110.8999999999999,
            days: 123,
            inOut: '入库',
            unitPrice: 0.005,
            price: -683.2034999999998,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 8,
              day: 31,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-08-31T01:05:43.720Z',
            number: 3004,
            name: '盘扣立杆架',
            count: -2,
            days: 123,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 9, day: 8, name: '扣件', inOut: '出库' },
            outDate: '2022-09-08T09:04:36.106Z',
            number: 100,
            name: '扣件',
            count: 600,
            days: 115,
            inOut: '出库',
            unitPrice: 0.003,
            price: 207,
            unit: '只',
            category: '租金',
          },
          {
            _id: { year: 2022, month: 9, day: 8, name: '钢管', inOut: '出库' },
            outDate: '2022-09-08T09:04:36.106Z',
            number: 6,
            name: '钢管',
            count: 200,
            days: 115,
            inOut: '出库',
            unitPrice: 0.0065,
            price: 149.5,
            unit: '米',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 9,
              day: 14,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-09-14T00:32:33.558Z',
            number: 2106,
            name: 'Φ48盘扣立杆',
            count: -1051.1,
            days: 109,
            inOut: '入库',
            unitPrice: 0.005,
            price: -572.8494999999999,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 9,
              day: 14,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-09-14T00:32:33.558Z',
            number: 3004,
            name: '盘扣立杆架',
            count: -2,
            days: 109,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 9,
              day: 25,
              name: '盘扣上托',
              inOut: '入库',
            },
            outDate: '2022-09-25T06:34:07.741Z',
            number: null,
            name: '盘扣上托',
            count: -5760,
            days: 98,
            inOut: '入库',
            unitPrice: 0.005,
            price: -2822.4,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 3,
              name: 'Φ48盘扣横杆',
              inOut: '入库',
            },
            outDate: '2022-10-03T07:58:04.286Z',
            number: null,
            name: 'Φ48盘扣横杆',
            count: -11019.4,
            days: 90,
            inOut: '入库',
            unitPrice: 0.005,
            price: -4958.73,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 3,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-10-03T07:58:04.286Z',
            number: null,
            name: 'Φ48盘扣立杆',
            count: -1285.6999999999998,
            days: 90,
            inOut: '入库',
            unitPrice: 0.005,
            price: -578.5649999999999,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 3,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-10-03T07:58:04.286Z',
            number: null,
            name: '盘扣立杆架',
            count: -26,
            days: 90,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 12,
              name: '扣件',
              inOut: '入库',
            },
            outDate: '2022-10-12T08:07:10.171Z',
            number: null,
            name: '扣件',
            count: -1317,
            days: 81,
            inOut: '入库',
            unitPrice: 0.003,
            price: -320.031,
            unit: '只',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 12,
              name: '钢管',
              inOut: '入库',
            },
            outDate: '2022-10-12T08:07:10.171Z',
            number: null,
            name: '钢管',
            count: -2263.5,
            days: 81,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -1191.73275,
            unit: '米',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 16,
              name: '盘扣上托',
              inOut: '入库',
            },
            outDate: '2022-10-16T01:46:19.160Z',
            number: null,
            name: '盘扣上托',
            count: -3840,
            days: 77,
            inOut: '入库',
            unitPrice: 0.005,
            price: -1478.3999999999999,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 16,
              name: '钢管架',
              inOut: '入库',
            },
            outDate: '2022-10-16T01:46:19.160Z',
            number: null,
            name: '钢管架',
            count: -2,
            days: 77,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 23,
              name: '扣件',
              inOut: '入库',
            },
            outDate: '2022-10-23T02:52:41.238Z',
            number: null,
            name: '扣件',
            count: -603,
            days: 70,
            inOut: '入库',
            unitPrice: 0.003,
            price: -126.63,
            unit: '只',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 23,
              name: '盘扣上托',
              inOut: '入库',
            },
            outDate: '2022-10-23T02:52:41.238Z',
            number: null,
            name: '盘扣上托',
            count: -2400,
            days: 70,
            inOut: '入库',
            unitPrice: 0.005,
            price: -840,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 23,
              name: '钢管',
              inOut: '入库',
            },
            outDate: '2022-10-23T02:52:41.238Z',
            number: null,
            name: '钢管',
            count: -179.6,
            days: 70,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -81.718,
            unit: '米',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 23,
              name: 'Φ48盘扣横杆',
              inOut: '入库',
            },
            outDate: '2022-10-23T09:17:39.037Z',
            number: null,
            name: 'Φ48盘扣横杆',
            count: -8400,
            days: 70,
            inOut: '入库',
            unitPrice: 0.005,
            price: -2940,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 23,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-10-23T09:17:39.037Z',
            number: null,
            name: '盘扣立杆架',
            count: -20,
            days: 70,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 29,
              name: 'Φ33盘扣斜杆',
              inOut: '入库',
            },
            outDate: '2022-10-29T03:48:07.171Z',
            number: null,
            name: 'Φ33盘扣斜杆',
            count: -1575,
            days: 64,
            inOut: '入库',
            unitPrice: 0.005,
            price: -504,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 29,
              name: 'Φ48盘扣横杆',
              inOut: '入库',
            },
            outDate: '2022-10-29T03:48:07.171Z',
            number: null,
            name: 'Φ48盘扣横杆',
            count: -24670,
            days: 64,
            inOut: '入库',
            unitPrice: 0.005,
            price: -7894.400000000001,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 29,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-10-29T03:48:07.171Z',
            number: null,
            name: '盘扣立杆架',
            count: -38,
            days: 64,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 29,
              name: '扣件',
              inOut: '出库',
            },
            outDate: '2022-10-29T04:24:47.520Z',
            number: null,
            name: '扣件',
            count: 1012,
            days: 64,
            inOut: '出库',
            unitPrice: 0.003,
            price: 194.304,
            unit: '只',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 29,
              name: '扣件',
              inOut: '入库',
            },
            outDate: '2022-10-29T06:48:31.368Z',
            number: null,
            name: '扣件',
            count: -509,
            days: 64,
            inOut: '入库',
            unitPrice: 0.003,
            price: -97.728,
            unit: '只',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 29,
              name: '盘扣上托',
              inOut: '入库',
            },
            outDate: '2022-10-29T06:48:31.368Z',
            number: null,
            name: '盘扣上托',
            count: -3360,
            days: 64,
            inOut: '入库',
            unitPrice: 0.005,
            price: -1075.2,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 29,
              name: '钢管',
              inOut: '入库',
            },
            outDate: '2022-10-29T06:48:31.368Z',
            number: null,
            name: '钢管',
            count: -590.6,
            days: 64,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -245.68959999999998,
            unit: '米',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 31,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-10-31T07:44:59.738Z',
            number: null,
            name: 'Φ48盘扣立杆',
            count: -7430.15,
            days: 62,
            inOut: '入库',
            unitPrice: 0.005,
            price: -2303.3465,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 10,
              day: 31,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-10-31T07:44:59.738Z',
            number: null,
            name: '盘扣立杆架',
            count: -12,
            days: 62,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 1,
              name: 'Φ48盘扣横杆',
              inOut: '入库',
            },
            outDate: '2022-11-01T06:33:34.095Z',
            number: null,
            name: 'Φ48盘扣横杆',
            count: -16800,
            days: 61,
            inOut: '入库',
            unitPrice: 0.005,
            price: -5124,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 1,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-11-01T06:33:34.095Z',
            number: null,
            name: 'Φ48盘扣立杆',
            count: -16285.15,
            days: 61,
            inOut: '入库',
            unitPrice: 0.005,
            price: -4966.9707499999995,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 1,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-11-01T06:33:34.095Z',
            number: null,
            name: '盘扣立杆架',
            count: -74,
            days: 61,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 2,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-11-02T05:37:40.171Z',
            number: null,
            name: 'Φ48盘扣立杆',
            count: -862.65,
            days: 60,
            inOut: '入库',
            unitPrice: 0.005,
            price: -258.795,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 2,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-11-02T05:37:40.171Z',
            number: null,
            name: '盘扣立杆架',
            count: -2,
            days: 60,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 8,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-11-08T08:04:23.119Z',
            number: null,
            name: 'Φ48盘扣立杆',
            count: -901.6999999999999,
            days: 54,
            inOut: '入库',
            unitPrice: 0.005,
            price: -243.45899999999997,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 8,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-11-08T08:04:23.119Z',
            number: null,
            name: '盘扣立杆架',
            count: -2,
            days: 54,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 29,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-11-29T03:23:48.635Z',
            number: null,
            name: 'Φ48盘扣立杆',
            count: -2592.1,
            days: 33,
            inOut: '入库',
            unitPrice: 0.005,
            price: -427.6965,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 11,
              day: 29,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-11-29T03:23:48.635Z',
            number: null,
            name: '盘扣立杆架',
            count: -4,
            days: 33,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 8,
              name: '盘扣上托',
              inOut: '入库',
            },
            outDate: '2022-12-08T06:44:07.941Z',
            number: null,
            name: '盘扣上托',
            count: -1440,
            days: 24,
            inOut: '入库',
            unitPrice: 0.005,
            price: -172.8,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 11,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-12-11T07:50:44.666Z',
            number: null,
            name: 'Φ48盘扣立杆',
            count: -1481.1999999999998,
            days: 21,
            inOut: '入库',
            unitPrice: 0.005,
            price: -155.52599999999998,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 11,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-12-11T07:50:44.666Z',
            number: null,
            name: '盘扣立杆架',
            count: -2,
            days: 21,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 17,
              name: 'Φ33盘扣斜杆',
              inOut: '出库',
            },
            outDate: '2022-12-17T00:52:57.227Z',
            number: null,
            name: 'Φ33盘扣斜杆',
            count: 6552,
            days: 15,
            inOut: '出库',
            unitPrice: 0.005,
            price: 491.4,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 17,
              name: '盘扣立杆架',
              inOut: '出库',
            },
            outDate: '2022-12-17T00:52:57.227Z',
            number: null,
            name: '盘扣立杆架',
            count: 8,
            days: 15,
            inOut: '出库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 20,
              name: 'Φ48盘扣横杆',
              inOut: '入库',
            },
            outDate: '2022-12-20T05:09:09.838Z',
            number: null,
            name: 'Φ48盘扣横杆',
            count: -924,
            days: 12,
            inOut: '入库',
            unitPrice: 0.005,
            price: -55.44,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 26,
              name: '盘扣上托',
              inOut: '入库',
            },
            outDate: '2022-12-26T07:29:13.173Z',
            number: null,
            name: '盘扣上托',
            count: -96,
            days: 6,
            inOut: '入库',
            unitPrice: 0.005,
            price: -2.88,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 28,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2022-12-28T07:27:38.802Z',
            number: null,
            name: 'Φ48盘扣立杆',
            count: -1107.6,
            days: 4,
            inOut: '入库',
            unitPrice: 0.005,
            price: -22.151999999999997,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2022,
              month: 12,
              day: 28,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2022-12-28T07:27:38.802Z',
            number: null,
            name: '盘扣立杆架',
            count: -2,
            days: 4,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
        ],
        group: { price: 2054.8466499999877 },
        nameGroup: [
          {
            _id: { name: 'Φ33盘扣斜杆' },
            name: 'Φ33盘扣斜杆',
            count: 4977,
            unit: '千克',
          },
          {
            _id: { name: '盘扣上托' },
            name: '盘扣上托',
            count: 1584,
            unit: '千克',
          },
          { _id: { name: '扣件' }, name: '扣件', count: 134, unit: '只' },
          { _id: { name: '钢管' }, name: '钢管', count: 1221.8, unit: '米' },
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -196,
            unit: '个',
          },
          {
            _id: { name: 'Φ48盘扣横杆' },
            name: 'Φ48盘扣横杆',
            count: -61813.4,
            unit: '千克',
          },
          { _id: { name: '钢管架' }, name: '钢管架', count: 2, unit: '个' },
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: -40720.75,
            unit: '千克',
          },
        ],
        debug: [],
        _id: '63b684224e2d809c871e9b83',
      },
      {
        name: '2021年   结算表',
        start: '2020-12-31T16:00:00.000Z',
        end: '2021-12-30T16:00:00.000Z',
        status: 'latest',
        history: [],
        list: [
          {
            _id: {
              year: 2021,
              month: 10,
              day: 30,
              name: 'Φ48盘扣立杆',
              inOut: '入库',
            },
            outDate: '2021-10-30T13:04:49.583Z',
            number: 2102,
            name: 'Φ48盘扣立杆',
            count: -8774.5,
            days: 63,
            inOut: '入库',
            unitPrice: 0.0065,
            price: -3593.15775,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2021,
              month: 10,
              day: 30,
              name: '盘扣立杆架',
              inOut: '入库',
            },
            outDate: '2021-10-30T13:04:49.583Z',
            number: 3004,
            name: '盘扣立杆架',
            count: -10,
            days: 63,
            inOut: '入库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
          {
            _id: { year: 2021, month: 11, day: 1, name: '扣件', inOut: '出库' },
            outDate: '2021-11-01T08:20:25.522Z',
            number: 100,
            name: '扣件',
            count: 810,
            days: 61,
            inOut: '出库',
            unitPrice: 0.0055,
            price: 271.755,
            unit: '只',
            category: '租金',
          },
          {
            _id: { year: 2021, month: 11, day: 1, name: '钢管', inOut: '出库' },
            outDate: '2021-11-01T08:20:25.522Z',
            number: 8,
            name: '钢管',
            count: 1322.5,
            days: 61,
            inOut: '出库',
            unitPrice: 0.009,
            price: 726.0524999999999,
            unit: '米',
            category: '租金',
          },
          {
            _id: {
              year: 2021,
              month: 12,
              day: 15,
              name: '扣件',
              inOut: '出库',
            },
            outDate: '2021-12-15T02:10:31.733Z',
            number: 102,
            name: '扣件',
            count: 300,
            days: 17,
            inOut: '出库',
            unitPrice: 0.0055,
            price: 28.049999999999997,
            unit: '只',
            category: '租金',
          },
          {
            _id: {
              year: 2021,
              month: 12,
              day: 15,
              name: '钢管',
              inOut: '出库',
            },
            outDate: '2021-12-15T02:10:31.733Z',
            number: 11,
            name: '钢管',
            count: 900,
            days: 17,
            inOut: '出库',
            unitPrice: 0.009,
            price: 137.7,
            unit: '米',
            category: '租金',
          },
          {
            _id: {
              year: 2021,
              month: 12,
              day: 30,
              name: 'Φ48盘扣横杆',
              inOut: '出库',
            },
            outDate: '2021-12-30T00:50:36.678Z',
            number: 2205,
            name: 'Φ48盘扣横杆',
            count: 95.2,
            days: 2,
            inOut: '出库',
            unitPrice: 0.0065,
            price: 1.2376,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2021,
              month: 12,
              day: 30,
              name: 'Φ48盘扣立杆',
              inOut: '出库',
            },
            outDate: '2021-12-30T00:50:36.678Z',
            number: 2106,
            name: 'Φ48盘扣立杆',
            count: 6879.099999999999,
            days: 2,
            inOut: '出库',
            unitPrice: 0.0065,
            price: 89.4283,
            unit: '千克',
            category: '租金',
          },
          {
            _id: {
              year: 2021,
              month: 12,
              day: 30,
              name: '盘扣立杆架',
              inOut: '出库',
            },
            outDate: '2021-12-30T00:50:36.678Z',
            number: 3004,
            name: '盘扣立杆架',
            count: 4,
            days: 2,
            inOut: '出库',
            unitPrice: 0,
            price: 0,
            unit: '个',
            category: '租金',
          },
        ],
        group: { price: -2338.93435 },
        nameGroup: [
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -6,
            unit: '个',
          },
          { _id: { name: '钢管' }, name: '钢管', count: 2222.5, unit: '米' },
          {
            _id: { name: 'Φ48盘扣横杆' },
            name: 'Φ48盘扣横杆',
            count: 95.2,
            unit: '千克',
          },
          { _id: { name: '扣件' }, name: '扣件', count: 1110, unit: '只' },
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: -1895.4000000000003,
            unit: '千克',
          },
        ],
        debug: [],
        _id: '63c0c58b4e2d809c872f69c6',
      },
      {
        name: '2023-01 月结算表',
        start: '2022-12-31T16:00:00.000Z',
        end: '2023-01-30T16:00:00.000Z',
        status: 'latest',
        history: [
          {
            _id: '钢管',
            name: '钢管',
            count: 1221.8,
            days: 31,
            price: 246.19270000000003,
            unit: '米',
            category: '租金',
            unitPrice: 0.0065000000000000014,
          },
          {
            _id: 'Φ48盘扣横杆',
            name: 'Φ48盘扣横杆',
            count: -61813.4,
            days: 31,
            price: -9581.077,
            unit: '千克',
            category: '租金',
            unitPrice: 0.005,
          },
          {
            _id: '钢管架',
            name: '钢管架',
            count: 2,
            days: 31,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
          {
            _id: '盘扣上托',
            name: '盘扣上托',
            count: 1584,
            days: 31,
            price: 245.52000000000015,
            unit: '千克',
            category: '租金',
            unitPrice: 0.005000000000000004,
          },
          {
            _id: 'Φ33盘扣斜杆',
            name: 'Φ33盘扣斜杆',
            count: 4977,
            days: 31,
            price: 771.435,
            unit: '千克',
            category: '租金',
            unitPrice: 0.005,
          },
          {
            _id: 'Φ48盘扣立杆',
            name: 'Φ48盘扣立杆',
            count: -40720.75,
            days: 31,
            price: -6311.7162499999995,
            unit: '千克',
            category: '租金',
            unitPrice: 0.005,
          },
          {
            _id: '扣件',
            name: '扣件',
            count: 134,
            days: 31,
            price: 12.461999999999989,
            unit: '只',
            category: '租金',
            unitPrice: 0.0029999999999999975,
          },
          {
            _id: '盘扣立杆架',
            name: '盘扣立杆架',
            count: -196,
            days: 31,
            price: 0,
            unit: '个',
            category: '租金',
            unitPrice: 0,
          },
        ],
        list: [],
        group: { price: -14617.18355 },
        nameGroup: [
          { _id: { name: '扣件' }, name: '扣件', count: 134, unit: '只' },
          {
            _id: { name: '盘扣立杆架' },
            name: '盘扣立杆架',
            count: -196,
            unit: '个',
          },
          { _id: { name: '钢管' }, name: '钢管', count: 1221.8, unit: '米' },
          {
            _id: { name: 'Φ48盘扣横杆' },
            name: 'Φ48盘扣横杆',
            count: -61813.4,
            unit: '千克',
          },
          { _id: { name: '钢管架' }, name: '钢管架', count: 2, unit: '个' },
          {
            _id: { name: 'Φ48盘扣立杆' },
            name: 'Φ48盘扣立杆',
            count: -40720.75,
            unit: '千克',
          },
          {
            _id: { name: '盘扣上托' },
            name: '盘扣上托',
            count: 1584,
            unit: '千克',
          },
          {
            _id: { name: 'Φ33盘扣斜杆' },
            name: 'Φ33盘扣斜杆',
            count: 4977,
            unit: '千克',
          },
        ],
        debug: [],
        _id: '63e5e33e4e2d809c87455c42',
      },
    ],
    createdAt: '2021-11-01T07:57:17.505Z',
    updatedAt: '2023-02-10T06:25:02.602Z',
    __v: 0,
  }
  if (contract && contract.calcs) {
    for (let calc of contract.calcs) {
      if (calc._id === calcId) {
        currentCalc = calc
      }
    }
  }

  if (!currentCalc) {
    return <></>
  }

  const descriptions = [
    { label: '项目部', children: <ProjectLabel projectId={contract.project} /> },
    { label: '状态', children: <Tag color="green">{contract.status}</Tag> },
    { label: "签约时间", children: moment(contract.date).format('YYYY-MM-DD') },
    { label: "结算名称", children: currentCalc.name },
    { label: "结算开始日期", children: moment(currentCalc.start).format('YYYY-MM-DD') },
    { label: "结算结束日期", children: moment(currentCalc.end).format('YYYY-MM-DD') },
    { label: '税率', children: percentFormat(currentCalc.taxRate, 0) },
    {
      label: '合同费用规则是否已含税',
      children: <Tag>{currentCalc.includesTax ? '已含' : '不含'}</Tag>,
    },
    { label: "备注", children: contract.comments },
  ]

  return (
    <PageHeader
      title={`${contract.name}结算表`}
      subTitle={contract.code}
      descriptions={descriptions}
      extra={[
        <Button key='reCalc' onClick={() => {
          restartCal({
            id,
            calcId,
            calc: _.omit(currentCalc, ['list', 'history', 'group', 'nameGroup']),
          })
        }}>重新计算</Button>,
        <ModalPrintPreviewButton key='printPreview' pdf={`/api/contract/${id}/calc/${calcId}/preview`}>打印预览</ModalPrintPreviewButton>,
        <Button type='primary' key='excel' onClick={() => {
          import('xlsx').then(XLSX => {
            rentExcelExport(XLSX, currentCalc, currentCalc.name + '-' + projectName)
          }).catch(() => {
            alert('加载 Excel 控件失败，请重试')
          })
        }}>导出 EXCEL</Button>,
      ]}
    >
      <Card>
        {currentCalc && <RentCalcTable rent={currentCalc} />}
      </Card>
    </PageHeader>
  )
}

export default ContractDetailsCalc